\usepackage{marginnote}
\usepackage{hang}
\usepackage{ifthen}

\newcommand{\maybe}[2]{\ifthenelse{\equal{#1}{Nothing}}{}{#2}}

\newcommand{\taskPoints}[1]{\marginpar{\sf\vspace*{-1em} {~~ #1~P.}}}
\newcommand{\subtaskPoints}[1]{\marginpar{\small\sf {~~/ #1}}}
\newcommand{\divSubtaskPoints}[1]{\marginnote{\small\sf {~~/ #1}}}
\newcommand{\stp}[1]{\subtaskPoints{#1}}

\newcounter{taskNumber}
\stepcounter{taskNumber}
\newcounter{subtaskNumber}
\newcommand{\resetSubtaskNumber}{%
 \setcounter{subtaskNumber}{1}%
}
\resetSubtaskNumber
\newcommand{\mkTaskLabel}[1]{\textsf{\textbf{#1}}}

\newcommand{\mktask}[5]{
  \maybe{#5}{\newpage{}}
  \maybe{#4}{\setcounter{taskNumber}{#4}}
  \bigskip
  \mkTaskLabel{Aufgabe%
  \maybe{#2}{\taskPoints{#2}}~%
  \arabic{taskNumber}\hspace{.66em} #1}%
  \maybe{#3}{\label{#3}}%
  \stepcounter{taskNumber}%
  \resetSubtaskNumber%
}

\newcommand{\subtaskLabel}{\mkTaskLabel{\alph{subtaskNumber})}}

\newcommand{\subtask}[4]{
  \maybe{#4}{\setcounter{subtaskNumber}{#4}}
  \subtaskLabel%
  \maybe{#2}{\subtaskPoints{#2}}%
  \maybe{#3}{\label{#3}}
  \stepcounter{subtaskNumber}
}

\newenvironment{divSubtask}[2]{%
  \maybe{#2}{\setcounter{subtaskNumber}{#2}}
  \begin{labeledpar}
    {\mkTaskLabel{w)}}
    {\subtaskLabel}
    \maybe{#1}{\divSubtaskPoints{#1}\vspace*{-\baselineskip}}%
    \stepcounter{subtaskNumber}}
  {\end{labeledpar}}
